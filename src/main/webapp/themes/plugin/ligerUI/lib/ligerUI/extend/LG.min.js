(function(e){window.LG={},LG.cookies=function(){var e=function(){};return e.prototype.get=function(e){var t="",n=e+"=";return document.cookie.length>0&&(offset=document.cookie.indexOf(n),offset!=-1&&(offset+=n.length,end=document.cookie.indexOf(";",offset),end==-1&&(end=document.cookie.length),t=decodeURIComponent(document.cookie.substring(offset,end)))),t},e.prototype.set=function(e,t,n){var r="",i=1;n!=null&&(i=n),r=new Date((new Date).getTime()+i*864e5),r="; expires="+r.toGMTString(),document.cookie=e+"="+encodeURIComponent(t)+";path=/"+r},e.prototype.remvoe=function(e){var t="";t=new Date((new Date).getTime()-1),t="; expires="+t.toGMTString(),document.cookie=e+"="+escape("")+";path=/"+t},new e}(),LG.tip=function(t){LG.wintip?(LG.wintip.set("content",t),LG.wintip.show()):LG.wintip=e.ligerDialog.tip({content:t}),setTimeout(function(){LG.wintip.hide()},4e3)},LG.prevLoadImage=function(t,n){for(var r in n)e("<img />").attr("src",t+n[r])},LG.showLoading=function(t){t=t||"正在加载中...",e("body").append("<div class='jloading'>"+t+"</div>"),e.ligerui.win.mask()},LG.hideLoading=function(t){e("body > div.jloading").remove(),e.ligerui.win.unmask({id:(new Date).getTime()})},LG.showSuccess=function(t,n){if(typeof t=="function"||arguments.length==0)n=t,t="操作成功!";e.ligerDialog.success(t,"提示信息",n)},LG.showError=function(t,n){if(typeof t=="function"||arguments.length==0)n=t,t="操作失败!";e.ligerDialog.error(t,"提示信息",n)},LG.prevDialogImage=function(e){e=e||baseURL,LG.prevLoadImage(e+"lib/ligerUI/skins/Aqua/images/win/",["dialog-icons.gif"]),LG.prevLoadImage(e+"lib/ligerUI/skins/Gray/images/win/",["dialogicon.gif"])},LG.ajax=function(t){var n=t||{},r=t.ashxUrl,i=n.url||r+e.param({type:n.type,method:n.method});e.ajax({cache:!1,async:!0,url:i,data:n.data,dataType:"json",type:"post",beforeSend:function(){LG.loading=!0,n.beforeSend?n.beforeSend():LG.showLoading(n.loading)},complete:function(){LG.loading=!1,n.complete?n.complete():LG.hideLoading()},success:function(e){if(!e)return;n.success?n.success(e):e.hasOk?alert("操作成功!"):alert("操作失败!失败信息如下:\n"+e.message+"\n如您对以上信息有疑问，请联系管理人员!")},error:function(e,t){LG.tip("发现系统错误 <BR>错误码："+e.status)}})},LG.getPageMenuNo=function(){var t=e("#MenuNo").val();return t||(t=getQueryStringByName("MenuNo")),t},LG.createButton=function(t){var n=e.extend({appendTo:e("body")},t||{}),r=e('<div class="button button2 buttonnoicon" style="width:60px"><div class="button-l"> </div><div class="button-r"> </div> <span></span></div>');n.icon&&(r.removeClass("buttonnoicon"),r.append('<div class="button-icon"> <img src="../'+n.icon+'" /> </div> ')),n.green&&r.removeClass("button2"),n.width&&r.width(n.width),n.click&&r.click(n.click),n.text&&e("span",r).html(n.text),typeof n.appendTo=="string"&&(n.appendTo=e(n.appendTo)),r.appendTo(n.appendTo)},LG.bulidFilterParams=function(t){if(!t)return null;var n=new Map;return e(":input",t).not(":submit, :reset, :image,:button, [disabled]").each(function(){if(!this.name)return;if(!e(this).hasClass("field"))return;if(e(this).val()==null||e(this).val()=="")return;var t=e(this).attr("ltype"),r=e(this).attr("ligerui"),i;r&&(i=JSON2.parse(r));var s=e(this).val(),o=this.name;t=="select"&&i&&i.valueFieldID&&(s=e("#"+i.valueFieldID).val(),o=i.valueFieldID),n.put(o,s)}),n.toJson()},LG.bulidFilterGroup=function(t){if(!t)return null;var n={op:"and",rules:[]};return e(":input",t).not(":submit, :reset, :image,:button, [disabled]").each(function(){if(!this.name)return;if(!e(this).hasClass("field"))return;if(e(this).val()==null||e(this).val()=="")return;var t=e(this).attr("ltype"),r=e(this).attr("ligerui"),i;r&&(i=JSON2.parse(r));var s=e(this).attr("op")||"like",o=e(this).attr("vt")||"string",u=e(this).val(),a=this.name;t=="select"&&i&&i.valueFieldID&&(u=e("#"+i.valueFieldID).val(),a=i.valueFieldID),n.rules.push({op:s,field:a,value:u,type:o})}),n},LG.appendSearchButtons=function(t,n,r){if(!t)return;t=e(t);var i=e('<ul><li style="margin-right:8px"></li><li></li></ul><div class="l-clear"></div>').appendTo(t);r?LG.addSearchButtons(t,n,i.find("li:eq(0)"),i.find("li:eq(1)")):LG.addSearchButtons(t,n,i.find("li:eq(0)"))},LG.addSearchButtons=function(e,t,n,r){if(!e)return;n&&LG.createButton({appendTo:n,text:"搜索",click:function(){var n=LG.bulidFilterParams(e);t.set("parms",n),t.loadData()}}),r&&LG.createButton({appendTo:r,width:80,text:"高级搜索",click:function(){t.showFilter()}})},LG.setFormDefaultBtn=function(e,t){var n=[];e&&n.push({text:"取消",onclick:e}),t&&n.push({text:"保存",onclick:t}),LG.addFormButtons(n)},LG.addFormButtons=function(t){if(!t)return;var n=e("body > div.form-bar");n.length==0&&(n=e('<div class="form-bar"><div class="form-bar-inner"></div></div>').appendTo("body")),t instanceof Array||(t=[t]),e(t).each(function(t,r){var i=e('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div> ');e("div.l-dialog-btn-inner:first",i).html(r.text||"BUTTON"),r.onclick&&i.bind("click",function(){r.onclick(r)}),r.width&&i.width(r.width),e("> div:first",n).append(i)})},LG.loadForm=function(t){t=t||{};var n;t.mainform||(n=e("form:first"));if(!n)return!1;e.ajax({type:"post",url:t.url,dataType:"json",data:t.datas,beforeSend:function(){LG.loading=!0,LG.showLoading("正在加载表单数据中...请稍候")},complete:function(){LG.loading=!1,LG.hideLoading()},success:function(r){if(!r)return LG.showError("数据加载失败!"),!1;var i=t.preID||"";for(var s in r){var o=e("[name="+(i+s)+"]",n);o.is(":checkbox,:radio")?o[0].checked=r[s]?!0:!1:o.val(r[s])}var u=e.ligerui.find(e.ligerui.controls.Input);for(var a=0,f=u.length;a<f;a++){var l=u[a];l.updateStyle(),u[a]instanceof e.ligerui.controls.TextBox&&l.checkValue()}if(t.detailForm)var c=t.detailForm,h=t.childName||"children";t.callback&&t.callback(r)}})},LG.submitForm=function(t,n,r){function i(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(i.name==t)return!0}return!1}t||(t=e("form:first")),t.valid()&&t.ajaxSubmit({dataType:"json",success:n,beforeSubmit:function(t,n,r){e(":checkbox,:radio",n).each(function(){i(t,this.name)||t.push({name:this.name,type:this.type,value:this.checked})});for(var s=0,o=t.length;s<o;s++){var u=t[s];if(u.type=="checkbox"||u.type=="radio")u.name&&e.trim(u.name)!=""?u.value=e("[name="+u.name+"]",n)[0].checked?"true":"false":u.value="false"}},beforeSend:function(e,t,n){LG.showLoading("正在保存数据中...")},complete:function(){LG.hideLoading()}})},LG.showInvalid=function(t){t=t||LG.validator;if(!t)return;var n='<div class="invalid">存在'+t.errorList.length+"个字段验证不通过，请检查!</div>";e.ligerDialog.error(n)},LG.validate=function(t,n){return typeof t=="string"?t=e(t):typeof t=="object"&&t.NodeType==1&&(t=e(t)),n=e.extend({errorPlacement:function(t,n){n.attr("id")||n.attr("id",(new Date).getTime()),n.hasClass("l-textarea")?n.addClass("l-textarea-invalid"):n.hasClass("l-text-field")&&n.parent().addClass("l-text-invalid"),e(n).removeAttr("title").ligerHideTip(),e(n).attr("title",t.html()).ligerTip({distanceX:5,distanceY:-3,auto:!0})},success:function(t){if(!t.attr("for"))return;var n=e("#"+t.attr("for"));n.hasClass("l-textarea")?n.removeClass("l-textarea-invalid"):n.hasClass("l-text-field")&&n.parent().removeClass("l-text-invalid"),e(n).removeAttr("title").ligerHideTip()}},n||{}),LG.validator=t.validate(n),LG.validator},LG.createToolbarButton=function(e,t){if(!e.toolbarManager)return;var n=[];for(var r=0;r<t.length;r++){var i=t[r];n[n.length]={click:i.clickEvent,text:i.name,img:baseURL+"/themes/default/icons"+i.icon,id:i.id},n[n.length]={line:!0}}e.toolbarManager.set("items",n)},LG.loadToolbar=function(e,t){var n=LG.getPageMenuNo();LG.ajax({loading:"正在加载工具条中...",type:"AjaxSystem",method:baseURL+"/loadFunctionButton.do1",data:{menuId:n},success:function(n){if(!e.toolbarManager)return;if(!n||!n.length)return;var r=[];for(var i=0,s=n.length;i<s;i++){var o=n[i];r[r.length]={click:t,text:o.BtnName,img:rootPath+o.BtnIcon,id:o.BtnNo},r[r.length]={line:!0}}e.toolbarManager.set("items",r)}})},LG.closeCurrentTab=function(t){t||(t=e("#framecenter > .l-tab-content > .l-tab-content-item:visible").attr("tabid")),tab&&tab.removeTabItem(t)},LG.closeAndReloadParent=function(t,n){var r=e("#"+n);tab&&tab.selectTabItem(n),r&&r.FF_Reload?r.FF_Reload():tab&&tab.reload(n),LG.closeCurrentTab(t)},LG.overrideGridLoading=function(){e.extend(e.ligerDefaults.Grid,{onloading:function(){LG.showLoading("正在加载表格数据中...")},onloaded:function(){LG.hideLoading()}})},LG.adujestConfig=function(t,n){if(t.Form&&t.Form.fields)for(var r=t.Form.fields.length-1;r>=0;r--){var i=t.Form.fields[r];e.inArray(i.name,n)!=-1&&t.Form.fields.splice(r,1)}if(t.Grid&&t.Grid.columns)for(var r=t.Grid.columns.length-1;r>=0;r--){var s=t.Grid.columns[r];e.inArray(s.name,n)!=-1&&t.Grid.columns.splice(r,1)}if(t.Search&&t.Search.fields)for(var r=t.Search.fields.length-1;r>=0;r--){var i=t.Search.fields[r];e.inArray(i.name,n)!=-1&&t.Search.fields.splice(r,1)}},LG.findToolbarItem=function(e,t){if(!e.toolbarManager)return null;if(!e.toolbarManager.options.items)return null;var n=e.toolbarManager.options.items;for(var r=0,i=n.length;r<i;r++)if(n[r].id==t)return n[r];return null},LG.setGridDoubleClick=function(e,t,n){t=t||toolbarBtnItemClick;if(!t)return;e.bind("dblClickRow",function(r){if(n){var i=LG.findToolbarItem(e,btnID);if(!i)return}e.select(r),t(r)})},LG.serialIdParam=function(e){if(!e||!e.length||e.length==0)return"";var t=[];for(var n=0;n<e.length;n++){var r=e[n];r.id&&r.id.length>0&&t.push(r.id)}return t.join(",")}})(jQuery)